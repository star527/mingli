<!-- pages/bazi/index.wxml -->
<view class="container">
  <!-- 排盘表单 -->
  <view class="bazi-form">
    <view class="form-title">八字排盘</view>
    
    <!-- 性别选择 -->
    <view class="form-group">
      <view class="form-label">性别</view>
      <view class="gender-selector">
        <view class="gender-item {{gender === 1 ? 'selected' : ''}}" bindtap="selectGender" data-gender="1">
          <text>男</text>
        </view>
        <view class="gender-item {{gender === 0 ? 'selected' : ''}}" bindtap="selectGender" data-gender="0">
          <text>女</text>
        </view>
      </view>
    </view>
    
    <!-- 出生日期和时间 -->
    <view class="form-group">
      <view class="form-label">出生日期</view>
      <view class="date-picker">
        <picker mode="date" value="{{birthDate}}" start="1900-01-01" end="{{currentDate}}" bindchange="onDateChange">
          <view class="picker">
            {{birthDate}}
          </view>
        </picker>
      </view>
    </view>
    
    <view class="form-group">
      <view class="form-label">出生时间</view>
      <view class="time-picker">
        <picker mode="time" value="{{birthTime}}" bindchange="onTimeChange">
          <view class="picker">
            {{birthTime}}
          </view>
        </picker>
      </view>
    </view>
    
    <!-- 计算按钮 -->
    <view class="calculate-btn" bindtap="calculateBazi">
      开始排盘
    </view>
  </view>
  
  <!-- 历史记录 -->
  <view class="history-section">
    <view class="section-header">
      <text class="section-title">历史记录</text>
      <view class="view-all" bindtap="viewAllRecords">
        <text>查看全部</text>
        <text class="arrow">→</text>
      </view>
    </view>
    
    <view class="history-list">
      <view wx:if="{{historyList.length > 0}}">
        <view wx:for="{{historyList}}" wx:key="id" class="history-item" bindtap="viewRecordDetail" data-id="{{item.id}}">
          <view class="record-info">
            <text class="record-date">{{item.birthDate}}</text>
            <text class="record-time">{{item.birthTime}}</text>
          </view>
          <view class="record-pillars">
            <text class="pillar-item">{{item.pillars.year[0]}}{{item.pillars.year[1]}}</text>
            <text class="pillar-item">{{item.pillars.month[0]}}{{item.pillars.month[1]}}</text>
            <text class="pillar-item">{{item.pillars.day[0]}}{{item.pillars.day[1]}}</text>
            <text class="pillar-item">{{item.pillars.hour[0]}}{{item.pillars.hour[1]}}</text>
          </view>
          <view class="record-actions">
            <text class="action-icon favorite" bindtap="toggleFavorite" data-id="{{item.id}}">
              {{item.isFavorite ? '★' : '☆'}}
            </text>
            <text class="action-icon delete" bindtap="deleteRecord" data-id="{{item.id}}">×</text>
          </view>
        </view>
      </view>
      <view wx:else class="empty-history">
        <text>暂无排盘记录</text>
      </view>
    </view>
  </view>
</view>